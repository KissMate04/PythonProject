# pylint: disable=import-error, no-member
"""
Contains the game loop, levels and the menu.
"""
import sys
import pygame
import game

def main():
    current_scene = "main_menu"
    pygame.font.init()

    LEVEL1 = [
        (0.25, 0.1),
        (0.5, 0.25)
    ]
    LEVEL2 = [
        (0.25, 0.1),
        (0.5, 0.25),
        (0.75, 0.1)
    ]
    LEVEL3 = [
        (0.25, 0.1),
        (0.5, 0.25),
        (0.75, 0.1),
        (0.25, 0.25),
        (0.75, 0.25)
    ]

    clock = pygame.time.Clock()
    screen = pygame.display.set_mode((0, 0), pygame.FULLSCREEN)  # the entire scrren
    SCREEN_WIDTH, SCREEN_HEIGHT = screen.get_size()
    GAME_WIDTH = 800  # width of the game area
    SIDE_WIDTH = (SCREEN_WIDTH - GAME_WIDTH) // 2  # width of each side area
    GAME_AREA = pygame.Rect(
        SIDE_WIDTH,
        20,
        GAME_WIDTH,
        SCREEN_HEIGHT - 40
    )

    def make_scene(name):
        if name == "main_menu":
            return game.MainScreen(GAME_AREA)
        if name == "level1":
            return game.LevelScene(GAME_AREA, LEVEL1, 1)
        if name == "level2":
            return game.LevelScene(GAME_AREA, LEVEL2, 2)
        if name == "level3":
            return game.LevelScene(GAME_AREA, LEVEL3, 3)
        if name == "over":
            return game.GameOverScreen(GAME_AREA)
        return game.MainScreen(GAME_AREA)

    #TODO Ã­rd felul a to stringet
    current_scene_name = "main_menu"
    current_scene = make_scene(current_scene_name)

    while True:
        events = pygame.event.get()
        if any(event.type == pygame.QUIT for event in events):
            pygame.quit()
            sys.exit()

        next_scene = current_scene.handle_events(events)

        if next_scene == "QUIT":
            pygame.quit()
            sys.exit()

        if next_scene != current_scene_name:
            print(next_scene, ", ", current_scene_name)
            current_scene_name = next_scene
            current_scene = make_scene(current_scene_name)

        current_scene.update(events)
        current_scene.draw(screen)



        pygame.display.flip()
        clock.tick(game.FPS)

if __name__ == "__main__":
    main()
